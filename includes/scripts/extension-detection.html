<script>(function(){

  const ABPDetectedCallbacks = [];

  function isABPDetected() {
    return !!document.documentElement.dataset.adblockPlusExtensionInfo;
  }

  adblock.api.isABPDetected = isABPDetected;

  function handleABPDetected() {
    try {
      adblock.extensions.adblockPlus = JSON.parse(document.documentElement.dataset.adblockPlusExtensionInfo);
    } catch (error) {
      adblock.extensions.adblockPlus = {};
      console.error("Failed to parse Adblock Plus extension injection", error);
    }
    ABPDetectedCallbacks.forEach(callback => callback());
  }

  adblock.api.onABPDetected = function onABPDetected(callback) {
    if (isABPDetected()) callback();
    else ABPDetectedCallbacks.push(callback);
  };

  if (isABPDetected()) {
    handleABPDetected();
  } else {
    const ABPDetectedObserver = new MutationObserver(() => {
      handleABPDetected();
      ABPDetectedObserver.disconnect();
    });
    ABPDetectedObserver.observe(document.documentElement, {
      attributeFilter: ["data-adblock-plus-extension-info"]
    });
  }

})()</script>