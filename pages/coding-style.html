title=Coding Style


<h2 id="precedence">{{s1 Precedence}}</h2>

<p>{{s2 The Adblock Plus coding style is based on others. Our rules (both general and language specific) always overrule referenced style guides. The language specific sections overrule the general section.}}</p>

<h2 id="consistency">{{s3 Consistency}}</h2>

<p>{{s4 Consistency is most important: Be consistent within functions, files, modules and projects. Making existing code conform with this style guide is fine, but it should happen in dedicated commits, preferably for a whole module or project at once.}}</p>

<h2 id="general">{{s5 General}}</h2>
<ul>
  <li>{{s8 All files should have a <a href="license-headers">license header</a>, but no mode line comments.}}</li>
  <li>{{s9 Newline at end of file, otherwise no trailing whitespace.}}</li>
  <li>{{s10 Lines can be longer than the limit, if limiting line length would hurt readability in a particular case.}}</li>
  <li>{{s11 Opening braces always go on their own line.}}</li>
  <li>{{s12 No hungarian notation, no special variable name prefixes or suffixes denoting type or scope. All variable names start with a lower case letter.}}</li>
  <li>{{s13 Don't comment code out, delete it.}}</li>
  <li>{{todo-comments Don't add TODO comments, create an issue and reference it in a comment instead.}}</li>
</ul>

<h2 id="javascript">{{s14 JavaScript}}</h2>
<ul>
  <li>Do not compare <code>x == true</code> or <code>x == false</code> (<code>x</code> or <code>!x</code> instead) </li>
  <li>Make sure that your code doesn't generate any strict JavaScript warnings </li>
  <li>Use <code>['value1, value2']</code> to create a JavaScript array </li>
  <li>Use <code>{ member: value, ... }</code> to create a JavaScript object </li>
  <li>If having defined a constructor you need to assign default properties (better than assign an object literal to the prototype property) </li>
  <li>Use regular expressions, but use wisely </li>
  <li>+++++++++++++++++++++++++++++++++++++++++++++++++++</li>

  <li>Don't put an <code>else</code> right after a <code>return</code> (or a <code>break</code>). Delete the <code>else</code>, it's unnecessary and increases indentation level.</li>
  <li>Don't leave debug <code>printf</code>s or <code>dump</code>s lying around.</li>
  <li>Use <a class="external external-icon" href="https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html">JavaDoc-style comments</a>.</li>
  <li>When fixing a problem, check to see if the problem occurs elsewhere in the same file, and fix it everywhere if possible.</li>
  <li>End the file with a newline. Make sure your patches don't contain files with the text "no newline at end of file" in them.</li>
  <li>Declare local variables as near to their use as possible.</li>
  <li>For new files, be sure to use the right <a class="external external-icon" href="https://www.mozilla.org/MPL/headers/" title="https://www.mozilla.org/MPL/headers/">license boilerplate</a>, per our <a class="external external-icon" href="https://www.mozilla.org/MPL/license-policy.html" title="https://www.mozilla.org/MPL/license-policy.html">license policy</a>.</li>
  <li>No tabs. No whitespace at the end of a line (use Unix-style linebreaks (<code>\n</code>)). </li>
  <li>Line length is 80 characters or less. </li>
  <li>Indentation is two spaces per logic level. </li>
  <li>Use <a class="external external-icon" href="https://en.wikipedia.org/wiki/Indentation_style#K&R_style">K&R bracing</a> style (left brace at end of first line, 'cuddled' `else` on both sides). </li>
  <li><code>Class</code> and <code>function</code> definitions are not control structures; left brace goes by itself on the second line and without extra indentation. </li>
  <li>Double-quoted strings (e.g. <code>"foo"</code>) (except embedded double quotes or event handlers). </li>
  <li>Methods and Functions should be <a class="external external-icon" href="https://en.wikipedia.org/wiki/Camel_case">camelCase</a> named. </li>
  <li>In-line functions should have spaces around braces. </li>
  <li>Constructors for objects should be <a class="external external-icon" href="https://en.wikipedia.org/wiki/Camel_case">PascalCase</a>. </li>
  <li>Expressions not joined by <code>&&</code> and <code>||</code> should break (same for <code>?:</code>, binary arithmetic operators including <code>+</code>, and member-of operators). </li>
  <li>Operator <code>==</code> is preferred to <code>===</code>. </li>

  <li>+++++++++++++++++++++++++++++++++++++++++++++++++++</li>
  <li>{{javascript-strict Always use <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a>.}}</li>
  <li>{{javascript-operator-linebreak When splitting overlong expressions into multiple lines the joining binary operators should be left at the end of the line, before the linebreak. This does not apply to member access operators, such as <code><fix>.</fix></code> which should be placed on the following line.}}</li>
  <li>{{javascript-if-else-braces When an <code><fix>if</fix></code> statement, an <code><fix>else</fix></code> statement or a loop spans over more than one line always enclose it with braces.}}</li>
  <li>{{s18 In classes, prefix private functions with a single underscore to make them pseudo-private.}}</li>
  <li>{{javascript-spacing-literals Don't add any spaces immediately after opening, or before closing, an object or array literal.}}</li>
  <h3 id="javascript-modern">{{javascript-es6 Modern JavaScript (where supported)}}</h3>
  <ul>
    <li>{{javascript-block-scoping Always use <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/block#With_let_and_const">block-scoping</a> (<code><fix>let</fix></code> / <code><fix>const</fix></code>), except when sharing global variables between scripts cannot be avoided.}}</li>
    <li>{{javascript-const Use <code><fix>const</fix></code> for constant expressions that could as well have been inlined (e.g. static parameters, imported modules, etc.).}}</li>
    <li>{{javascript-arrow Use the <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow function</a> syntax when passing anonymous functions that don't require the binding of their own <code><fix>this</fix></code> or <code><fix>arguments</fix></code> variables.}}</li>
    <li>{{javascript-method Use the <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Functions/Method_definitions">method definition shorthand</a> syntax when defining methods on an object.}}</li>
    <li>{{javascript-for-of When iterating over arrays in the canonical order use the new <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/for...of"><code><fix>for..of</fix></code></a> syntax if the loop index isn't required. (Rather than using <code><fix>for(;;)</fix></code> or the <code><fix>forEach()</fix></code> method.)}}</li>
    <li>{{javascript-map-set Use the <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map"><code><fix>Map</fix></code></a> or <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Set"><code><fix>Set</fix></code></a> objects, rather than misusing plain objects, when you need a hash table.}}</li>
    <li>{{javascript-eslint Run <a href="http://eslint.org"><fix>ESLint</fix></a> with the <a href="https://gitlab.com/eyeo/auxiliary/eyeo-coding-style/tree/master/eslint-config-eyeo"><fix>eslint-config-eyeo</fix></a> configuration and fix any warning.}}</li>
  </ul>
</ul>

<h2 id="html-css">{{html-css HTML and CSS}}</h2>
<ul>
  <li>Use valid CSS where possible. </li>
  <li>Use short, generic and meaningful names (purpose of the element). </li>
  <li>Avoid <code>tag.class</code> or <code>tag.id</code> when possible. </li>
  <li>▚▚ 1 ▚ Use shorthand properties where possible. </li>
  <li>Omit unit specification after “0” values, unless required. </li>
  <li>▚▚ 2 ▚ Omit leading “0”s in values (<code>.2em</code>). </li>
  <li>▚▚ 3 ▚ Use 3 character hexadecimal notation where possible (<code>color: #ebc;</code>). </li>
  <li>Prefix selectors with an application-specific prefix (Optional, e.g.<code>.adw-note</code>). </li>
  <li>Separate words in ID and class names by a hyphen. </li>
  <li>Avoid user agent detection as well as CSS “hacks”: Try a different approach first. </li>
  <li>▚▚ 5 ▚Alphabetize declarations. </li>
  <li>Indent all block content. </li>
  <li>Use a semicolon after every declaration. </li>
  <li>Use a space after a property name’s colon. </li>
  <li>Use a space between the last selector and the declaration block (not new line). </li>
  <li>Separate selectors and declarations by new lines. </li>
  <li>Separate rules by new lines. </li>
  <li>▚▚ 4 ▚ Use single (<code>''</code>) rather than double (<code>""</code>) quotation marks for attribute selectors and property values. </li>
  <li>Group sections by a section comment (optional). </li>
  <li>+++++++++++++++++++++++++++++++++++++++++++++++++++</li>
  <li>▚▚ 4 ▚ {{html-css-quotation Use double over single quotation marks.}}</li>
  <li>{{html-css-optional-tag Don't omit optional HTML tags.}}</li>
  <li>▚▚ 3 ▚ {{html-css-hexadecimal CSS color values should be specified in hexadecimal where possible.}}</li>
  <li>▚▚ 1 ▚ {{html-css-shorthand CSS shorthand properties usage is optional.}}</li>
  <li>▚▚ 5 ▚ {{html-css-order CSS rule declaration order should follow the <a href="https://make.wordpress.org/core/handbook/best-practices/coding-standards/css/#property-ordering">WordPress CSS Coding Standards</a>.}}</li>
  <li>▚▚ 2 ▚ {{html-css-leading-zero Don't omit the optional leading 0 for decimal numbers.}}</li>
  <li>{{html-css-single-line CSS declaration blocks with a single selector and a single rule can be written in a single line.}}</li>
  <li>{{ html-css-font-unit CSS font weight values should be specified in relative or numerical notation }}</li>
</ul>

<h2 id="python">{{s19 Python}}</h2>
<ul>
  <li>{{python-general Follow <a href="https://www.python.org/dev/peps/pep-0008/"><fix>PEP-8</fix></a> and the recommendations in the offical <fix>Python</fix> documentation.}}</li>
  <li>{{python-version Make the code compatible with <fix>Python 3.5+</fix>.}}</li>
  <li>{{python-strings Write string literals so that they match the behaviour of <a href="https://docs.python.org/3/library/functions.html#ascii"><code><fix>ascii()</fix></code></a>, i.e. use single quotes except to avoid escaping of embedded quotes and use <code><fix>\u</fix></code> escapes for non-ascii characters but don't prefix strings with <code><fix>u</fix></code>. For docstrings, however, follow <a href="https://www.python.org/dev/peps/pep-0257/">PEP-257</a>.}}</li>
  <li>{{python-prefix In modules, prefix private functions and variables with a single underscore.}}</li>
  <li>{{python-concatenation Use the <code><fix>+</fix></code> operator when concatenating exactly two strings, use the <a href="https://docs.python.org/3/library/stdtypes.html#str.format"><code><fix>format()</fix></code> method</a> for more complex string formatting, use the <a href="https://docs.python.org/3/library/stdtypes.html#str.join"><code><fix>join()</fix></code> method</a> when concatenating pre-existing sequences.}}</li>
  <li>{{python-tuple-vs-list Use tuples for data that have structure, use lists for data that have order.}}</li>
  <li>{{python-builtins Don't override builtins.}}</li>
  <li>{{python-map-filter Use list comprehensions or generator expressions instead of calling <code><fix>map()</fix></code> or <code><fix>filter()</fix></code> with a lambda function.}}</li>
  <li>{{python-multiline The preferred way of wrapping long lines is by using Python's implied line continuation inside parentheses, brackets and braces. Long lines can be broken over multiple lines by wrapping expressions in parentheses:}}
    <ol>
      <li>{{python-multiline-a1[list item] aligning follow up lines with the opening parentheses and putting the closing parentheses at the end of the last line}}
          (<a onclick="getElementById('python-multiline-a1-example').classList.toggle('hide');">{{python-multiline-a1-example example}}</a>), or
        <pre class="hide" id="python-multiline-a1-example">
    long_object_name.long_method_name(argument1, argument2,
                                      keyword_argument=value)

    very_long_variable = ['a list of', 'strings that does not',
                          'fit into', 'one line']
        </pre>
      </li>
      <li>{{python-multiline-a2[list item] breaking the line at the opening parentheses, indenting follow up lines by 4 spaces, and placing the closing parentheses on a separate line that is aligned with the line that contains the opening parentheses}}
          (<a onclick="getElementById('python-multiline-a2-example').classList.toggle('hide');">{{python-multiline-a2-example example}}</a>).
        <pre class="hide" id="python-multiline-a2-example">
    long_object_name.long_method_name(
        argument1,
        argument2,
        keyword_argument=value,
    )

    very_long_variable = [
        'a list of',
        'strings that does not',
        'fit into',
        'one line',
    ]
        </pre>
      </li>
    </ol>
    {{python-multiline-commas When breaking lists of items separated by commas (e.g. lists, dicts, argument lists) using the second approach add a comma after the last element. This allows adding and rearranging items without touching unrelated lines.}}
  </li>
  <li>{{python-regexp Use <a href="https://docs.python.org/2/library/re.html#re.search"><code><fix>re.search()</fix></code></a> instead of <code><fix>re.match()</fix></code> to avoid <a href="https://docs.python.org/2/library/re.html#search-vs-match">confusion</a> about implied beginning of the string but not the ending.}}</li>
  <li>
    {{python-flake8 Run <a href="https://pypi.python.org/pypi/flake8"><fix>flake8</fix></a> with following extensions and fix all reported errors:}}
    <ul>
      <li><a href="https://gitlab.com/eyeo/auxiliary/eyeo-coding-style/tree/master/flake8-eyeo">flake8-eyeo</a></li>
      <li><a href="https://pypi.python.org/pypi/flake8-docstrings">flake8-docstrings</a> ({{python-flake8-docstring-exception with <code><fix>D1</fix></code> ignored}})</li>
      <li><a href="https://pypi.python.org/pypi/flake8-commas">flake8-commas</a></li>
      <li><a href="https://pypi.python.org/pypi/pep8-naming">pep8-naming</a></li>
    </ul>
  </li>
  <li>{{python-tests Write tests and have them run along <fix>flake8</fix> using <a href="https://pypi.python.org/pypi/tox"><fix>tox</fix></a>.}}</li>
</ul>

<h2 id="java">{{s22 Java}}</h2>
<ul>
  <li>{{s23 Follow the Mozilla Coding Style's <a href="https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Coding_Style$revision/1562743#Java_practices">Java practices</a>.}}</li>
  <li>{{s24 Imports should be organised consistently per file, we don't use global rules.}}</li>
</ul>

<h2 id="cpp">{{s25 C++}}</h2>
<ul>
  <li>{{s26 Follow the Mozilla Coding Style's <a href="https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Coding_Style$revision/1562743#CC_practices">C++ practices</a>.}}</li>
  <li>{{s27 Indent namespace bodies.}}</li>
  <li>{{s28 Avoid manual memory management: Use references and values when possible, smart pointers when necessary, raw pointers only for weak references.}}</li>
  <li>{{s29 Don't use C-style casts unless its exact semantics are required.}}</li>
  <li>{{s30 We tend to use anonymous namespaces instead of static.}}</li>
</ul>

<h2 id="objc">{{objective-c Objective-C}}</h2>
<ul>
  <li>{{objc-conventions Follow Apple's <a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Conventions/Conventions.html">conventions</a>}}.</li>
</ul>

<h2 id="puppet">{{s31 Puppet}}</h2>
<ul>
  <li>{{s32 Follow the <a href="https://puppet.com/docs/puppet/latest/style_guide.html">Puppet Style Guide</a>.}}</li>
  <li>{{s33 Opening braces don't go on their own line.}}</li>
  <li>{{s34 Arrows should not be aligned.}}</li>
</ul>
